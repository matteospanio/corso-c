---
title: XOR cipher
---

Due spie si scambiano messaggi crittografati per comunicare tra loro.
Una spia di un'altra organizzazione ha intercettato diversi messaggi e ha scoperto
che si tratta di messaggi crittografati con un algoritmo molto semplice:
ogni carattere del messaggio è stato trasformato in un altro carattere tramite
XOR con una chiave segreta. La chiave è una stringa di lunghezza variabile.
Dopo molti mesi di lavoro la spia è riuscita a scoprire che la parola "Arrivederci"
quando crittografata con la chiave "s3gr3t0" diventa "2AriEeTerPi".

Lo pseudocodice dell'algoritmo di crittografia è il seguente:

```
encodec(msg, key, dst)
    for i = 0 to len(msg)
        dst[i] = msg[i] <xor> key[i % len(key)]
        if not is_printable(dst[i])
            dst[i] = msg[i]
```

Aiuta la spia implementando l'algoritmo di decodifica in C.

Dal momento che i messaggi intercettati sono molto lunghi, questi vengono memorizzati come una lista di stringhe. Ogni stringa contiene al massimo 1000 caratteri.
Implementa una funzione `encodec_list` che usi la funzione `encodec` per decodificare una lista di stringhe.

{{< downloadthis ./secrets_exercise.zip dname="secrets.zip" label="Scarica il file" >}}
